#!/usr/bin/env bash

function bootstrap {
  local shome="$(unset CDPATH; cd -P -- "$(dirname -- "$BASH_SOURCE")/.." && pwd -P)"
  source "$shome/script/profile"

  local url_go_Darwin='https://storage.googleapis.com/golang/go1.5.3.darwin-amd64.tar.gz'
  local url_go_Linux='https://storage.googleapis.com/golang/go1.5.3.linux-amd64.tar.gz'

  local tmp_go="$(mktemp -t XXXXXX)"
  trap "$(printf "rm -f '%q'" "$tmp_go")" EXIT
  case "$(uname -s)" in
    Darwin)
      curl -L -o "$tmp_go" "$url_go_Darwin"
      ;;
    Linux)
      curl -L -o "$tmp_go" "$url_go_Linux"
      ;;
  esac

  mkdir -p "$shome/install"
  pushd "$shome/install"
  tar xvfz "$tmp_go"
  popd
}

bootstrap
